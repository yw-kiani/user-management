"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
<<<<<<< HEAD
exports.getReadPreference = getReadPreference;
exports.isSharded = isSharded;
=======
exports.isSharded = exports.getReadPreference = void 0;
>>>>>>> 3b4aa5cdae276595da8907889ecc433635ccc98d
const error_1 = require("../../error");
const read_preference_1 = require("../../read_preference");
const common_1 = require("../../sdam/common");
const topology_description_1 = require("../../sdam/topology_description");
function getReadPreference(options) {
<<<<<<< HEAD
    // Default to command version of the readPreference.
    let readPreference = options?.readPreference ?? read_preference_1.ReadPreference.primary;
=======
    // Default to command version of the readPreference
    let readPreference = options?.readPreference ?? read_preference_1.ReadPreference.primary;
    // If we have an option readPreference override the command one
    if (options?.readPreference) {
        readPreference = options.readPreference;
    }
>>>>>>> 3b4aa5cdae276595da8907889ecc433635ccc98d
    if (typeof readPreference === 'string') {
        readPreference = read_preference_1.ReadPreference.fromString(readPreference);
    }
    if (!(readPreference instanceof read_preference_1.ReadPreference)) {
        throw new error_1.MongoInvalidArgumentError('Option "readPreference" must be a ReadPreference instance');
    }
    return readPreference;
}
<<<<<<< HEAD
=======
exports.getReadPreference = getReadPreference;
>>>>>>> 3b4aa5cdae276595da8907889ecc433635ccc98d
function isSharded(topologyOrServer) {
    if (topologyOrServer == null) {
        return false;
    }
    if (topologyOrServer.description && topologyOrServer.description.type === common_1.ServerType.Mongos) {
        return true;
    }
    // NOTE: This is incredibly inefficient, and should be removed once command construction
<<<<<<< HEAD
    // happens based on `Server` not `Topology`.
=======
    //       happens based on `Server` not `Topology`.
>>>>>>> 3b4aa5cdae276595da8907889ecc433635ccc98d
    if (topologyOrServer.description && topologyOrServer.description instanceof topology_description_1.TopologyDescription) {
        const servers = Array.from(topologyOrServer.description.servers.values());
        return servers.some((server) => server.type === common_1.ServerType.Mongos);
    }
    return false;
}
<<<<<<< HEAD
=======
exports.isSharded = isSharded;
>>>>>>> 3b4aa5cdae276595da8907889ecc433635ccc98d
//# sourceMappingURL=shared.js.map