import type { Collection } from '../collection';
<<<<<<< HEAD
import { executeOperation } from '../operations/execute_operation';
import { ListIndexesOperation, type ListIndexesOptions } from '../operations/indexes';
import type { ClientSession } from '../sessions';
import { AbstractCursor, type InitialCursorResponse } from './abstract_cursor';
=======
import { executeOperation, type ExecutionResult } from '../operations/execute_operation';
import { ListIndexesOperation, type ListIndexesOptions } from '../operations/indexes';
import type { ClientSession } from '../sessions';
import { AbstractCursor } from './abstract_cursor';
>>>>>>> 3b4aa5cdae276595da8907889ecc433635ccc98d

/** @public */
export class ListIndexesCursor extends AbstractCursor {
  parent: Collection;
  options?: ListIndexesOptions;

  constructor(collection: Collection, options?: ListIndexesOptions) {
    super(collection.client, collection.s.namespace, options);
    this.parent = collection;
    this.options = options;
  }

  clone(): ListIndexesCursor {
    return new ListIndexesCursor(this.parent, {
      ...this.options,
      ...this.cursorOptions
    });
  }

  /** @internal */
<<<<<<< HEAD
  async _initialize(session: ClientSession | undefined): Promise<InitialCursorResponse> {
=======
  async _initialize(session: ClientSession | undefined): Promise<ExecutionResult> {
>>>>>>> 3b4aa5cdae276595da8907889ecc433635ccc98d
    const operation = new ListIndexesOperation(this.parent, {
      ...this.cursorOptions,
      ...this.options,
      session
    });

<<<<<<< HEAD
    const response = await executeOperation(this.parent.client, operation, this.timeoutContext);

=======
    const response = await executeOperation(this.parent.client, operation);

    // TODO: NODE-2882
>>>>>>> 3b4aa5cdae276595da8907889ecc433635ccc98d
    return { server: operation.server, session, response };
  }
}
